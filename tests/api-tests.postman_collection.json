{
  "info": {
    "name": "ITAM API Tests",
    "description": "Comprehensive API testing collection for IT Asset Management System (excluding software APIs)",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "assetId",
      "value": "",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "",
      "type": "string"
    },
    {
      "key": "borrowId",
      "value": "",
      "type": "string"
    },
    {
      "key": "inventoryId",
      "value": "",
      "type": "string"
    },
    {
      "key": "patchId",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Health Check",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/health",
              "host": ["{{baseUrl}}"],
              "path": ["api", "health"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Auth",
      "item": [
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has success property\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('success');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"employee_id\": \"EMP-101\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "login"]
            }
          },
          "response": []
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/auth/logout",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "logout"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Assets",
      "item": [
        {
          "name": "Get All Assets",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response is an array\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.be.an('array');",
                  "});",
                  "",
                  "// Save first asset ID for later tests",
                  "if (pm.response.json().data.length > 0) {",
                  "    pm.collectionVariables.set('assetId', pm.response.json().data[0].id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/assets",
              "host": ["{{baseUrl}}"],
              "path": ["api", "assets"]
            }
          },
          "response": []
        },
        {
          "name": "Create Asset",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200 or 201\", function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
                  "});",
                  "",
                  "pm.test(\"Asset created successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "    if (jsonData.data && jsonData.data.id) {",
                  "        pm.collectionVariables.set('assetId', jsonData.data.id);",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"asset_tag\": \"TEST-{{$timestamp}}\",\n  \"type\": \"laptop\",\n  \"manufacturer\": \"Dell\",\n  \"model\": \"Latitude 5420\",\n  \"serialnumber\": \"SN{{$timestamp}}\",\n  \"status\": \"available\",\n  \"department\": \"IT\",\n  \"purchasedate\": \"2024-01-01\",\n  \"purchaseprice\": 25000\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/assets",
              "host": ["{{baseUrl}}"],
              "path": ["api", "assets"]
            }
          },
          "response": []
        },
        {
          "name": "Get Asset by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/assets/{{assetId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "assets", "{{assetId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Update Asset",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"assigned\",\n  \"notes\": \"Updated via API test\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/assets/{{assetId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "assets", "{{assetId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Get Asset History",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/assets/{{assetId}}/history",
              "host": ["{{baseUrl}}"],
              "path": ["api", "assets", "{{assetId}}", "history"]
            }
          },
          "response": []
        },
        {
          "name": "Delete Asset",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/assets/{{assetId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "assets", "{{assetId}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Users",
      "item": [
        {
          "name": "Get All Users",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.json().data && pm.response.json().data.length > 0) {",
                  "    pm.collectionVariables.set('userId', pm.response.json().data[0].id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users"]
            }
          },
          "response": []
        },
        {
          "name": "Create User",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"User created successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "    if (jsonData.data && jsonData.data.id) {",
                  "        pm.collectionVariables.set('userId', jsonData.data.id);",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"firstname\": \"Test\",\n  \"lastname\": \"User\",\n  \"email\": \"test{{$timestamp}}@example.com\",\n  \"employee_id\": \"EMP-{{$timestamp}}\",\n  \"department\": \"IT\",\n  \"role\": \"Staff\",\n  \"location\": \"Bangkok\",\n  \"status\": \"active\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/users",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users"]
            }
          },
          "response": []
        },
        {
          "name": "Get User by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users", "{{userId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Update User",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"phone\": \"0812345678\",\n  \"location\": \"Chiang Mai\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/users/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users", "{{userId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Delete User",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users", "{{userId}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Inventory",
      "item": [
        {
          "name": "Get All Inventory",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.json().data && pm.response.json().data.length > 0) {",
                  "    pm.collectionVariables.set('inventoryId', pm.response.json().data[0].id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/inventory",
              "host": ["{{baseUrl}}"],
              "path": ["api", "inventory"]
            }
          },
          "response": []
        },
        {
          "name": "Create Inventory Item",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Item created successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "    if (jsonData.data && jsonData.data.id) {",
                  "        pm.collectionVariables.set('inventoryId', jsonData.data.id);",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Test Item {{$timestamp}}\",\n  \"barcode\": \"BC{{$timestamp}}\",\n  \"category\": \"Office Supplies\",\n  \"quantity\": 100,\n  \"unit\": \"pieces\",\n  \"unit_price\": 10,\n  \"min_stock\": 20,\n  \"location\": \"Warehouse A\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/inventory",
              "host": ["{{baseUrl}}"],
              "path": ["api", "inventory"]
            }
          },
          "response": []
        },
        {
          "name": "Get Inventory by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/inventory/{{inventoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "inventory", "{{inventoryId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Update Inventory",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"quantity\": 150,\n  \"min_stock\": 30\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/inventory/{{inventoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "inventory", "{{inventoryId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Dispense Inventory",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"itemId\": \"{{inventoryId}}\",\n  \"quantityToDispense\": 10,\n  \"userId\": \"{{userId}}\",\n  \"notes\": \"Test dispense\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/inventory/dispense",
              "host": ["{{baseUrl}}"],
              "path": ["api", "inventory", "dispense"]
            }
          },
          "response": []
        },
        {
          "name": "Return Inventory",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"itemId\": \"{{inventoryId}}\",\n  \"quantityToReturn\": 5,\n  \"userId\": \"{{userId}}\",\n  \"notes\": \"Test return\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/inventory/return",
              "host": ["{{baseUrl}}"],
              "path": ["api", "inventory", "return"]
            }
          },
          "response": []
        },
        {
          "name": "Adjust Inventory",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"itemId\": \"{{inventoryId}}\",\n  \"newQuantity\": 120,\n  \"reason\": \"Physical count adjustment\",\n  \"notes\": \"Test adjustment\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/inventory/adjust",
              "host": ["{{baseUrl}}"],
              "path": ["api", "inventory", "adjust"]
            }
          },
          "response": []
        },
        {
          "name": "Get Inventory Dashboard",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/inventory/dashboard",
              "host": ["{{baseUrl}}"],
              "path": ["api", "inventory", "dashboard"]
            }
          },
          "response": []
        },
        {
          "name": "Get Inventory Reports",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/inventory/reports",
              "host": ["{{baseUrl}}"],
              "path": ["api", "inventory", "reports"]
            }
          },
          "response": []
        },
        {
          "name": "Delete Inventory",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/inventory/{{inventoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "inventory", "{{inventoryId}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Borrowing",
      "item": [
        {
          "name": "Get All Borrow Records",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.json().data && pm.response.json().data.length > 0) {",
                  "    pm.collectionVariables.set('borrowId', pm.response.json().data[0].id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/borrowing",
              "host": ["{{baseUrl}}"],
              "path": ["api", "borrowing"]
            }
          },
          "response": []
        },
        {
          "name": "Checkout Asset",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Checkout successful\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "    if (jsonData.data && jsonData.data.id) {",
                  "        pm.collectionVariables.set('borrowId', jsonData.data.id);",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"asset_tag\": \"{{assetId}}\",\n  \"borrowerId\": \"{{userId}}\",\n  \"due_date\": \"2024-12-31\",\n  \"purpose\": \"Testing\",\n  \"notes\": \"API test checkout\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/borrowing",
              "host": ["{{baseUrl}}"],
              "path": ["api", "borrowing"]
            }
          },
          "response": []
        },
        {
          "name": "Get Borrow Record by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/borrowing/{{borrowId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "borrowing", "{{borrowId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Checkin Asset",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"returned\",\n  \"checkin_date\": \"2024-12-04\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/borrowing/{{borrowId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "borrowing", "{{borrowId}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Patches",
      "item": [
        {
          "name": "Get All Patches",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.json().data && pm.response.json().data.length > 0) {",
                  "    pm.collectionVariables.set('patchId', pm.response.json().data[0].id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/patches",
              "host": ["{{baseUrl}}"],
              "path": ["api", "patches"]
            }
          },
          "response": []
        },
        {
          "name": "Create Patch Record",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Patch created successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "    if (jsonData.data && jsonData.data.id) {",
                  "        pm.collectionVariables.set('patchId', jsonData.data.id);",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"assetId\": \"{{assetId}}\",\n  \"patchStatus\": \"up-to-date\",\n  \"operatingSystem\": \"Windows 11\",\n  \"vulnerabilities\": 0,\n  \"pendingUpdates\": 0,\n  \"criticalUpdates\": 0,\n  \"securityUpdates\": 0\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/patches",
              "host": ["{{baseUrl}}"],
              "path": ["api", "patches"]
            }
          },
          "response": []
        },
        {
          "name": "Get Patch by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/patches/{{patchId}}?include=history",
              "host": ["{{baseUrl}}"],
              "path": ["api", "patches", "{{patchId}}"],
              "query": [
                {
                  "key": "include",
                  "value": "history"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Update Patch",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"patchStatus\": \"needs-review\",\n  \"pendingUpdates\": 5,\n  \"notes\": \"Updated via API test\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/patches/{{patchId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "patches", "{{patchId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Get Patch History",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/patches/{{patchId}}/history",
              "host": ["{{baseUrl}}"],
              "path": ["api", "patches", "{{patchId}}", "history"]
            }
          },
          "response": []
        },
        {
          "name": "Delete Patch",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/patches/{{patchId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "patches", "{{patchId}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Dashboard",
      "item": [
        {
          "name": "Get Dashboard Stats",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has required properties\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('success');",
                  "    pm.expect(jsonData).to.have.property('data');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/dashboard",
              "host": ["{{baseUrl}}"],
              "path": ["api", "dashboard"]
            }
          },
          "response": []
        }
      ]
    }
  ]
}
